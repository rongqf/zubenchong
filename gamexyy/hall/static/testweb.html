<!DOCTYPE html>

<html>

<head>


<title>Testing websockets</title>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script src="http://libs.baidu.com/jquery/1.9.1/jquery.min.js"></script>
<script>

var skey = '';
var userid = 0;


$(document).ready(function(){
    $.get('/api?action=login&param={"username":"test5","password":"112233"}',function(data,status){
      tmp = JSON.parse(data);
      console.log(tmp)
      skey = tmp["data"]['skey'];
      userid = tmp["data"]['userid']
	  document.getElementById('messages').innerHTML += '<br />'  + data;
	  
	  
      //alert("数据：" + data + "\n状态：" + status);
    });
});


function userinfo()
{

  var param = {"skey":skey, "userid":userid};
  var url = '/api?action=userinfo&param=' + JSON.stringify(param);
  console.log(url);
  $.get(url, function(data,status)
  {
      tmp = JSON.parse(data);
      
      document.getElementById('userinfo').innerHTML =  data;
    
      //alert("数据：" + data + "\n状态：" + status);
    });
}

function getconfig()
{
  var url = '/api?action=getconfig&param={}';
  console.log(url);
  $.get(url, function(data,status)
  {
      tmp = JSON.parse(data);
      
      document.getElementById('getconfig').innerHTML =  data;
    
      //alert("数据：" + data + "\n状态：" + status);
    });
}


function getmap(otherid=0)
{
  var param = {"skey":skey, "userid":userid, "otherid":otherid};
  var url = '/api?action=getmap&param=' + JSON.stringify(param);
  console.log(url);
  $.get(url, function(data,status)
  {
      tmp = JSON.parse(data);
      
      document.getElementById('map').innerHTML += '<br />'  + data;
    
      //alert("数据：" + data + "\n状态：" + status);
    });
}

function getmapgen(otherid=0)
{
  var param = {"skey":skey, "userid":userid, "otherid":otherid};
  var url = '/api?action=getmapgen&param=' + JSON.stringify(param);
  console.log(url);
  $.get(url, function(data,status)
  {
      tmp = JSON.parse(data);
      
      document.getElementById('mapgen').innerHTML += '<br />'  + data;
    
      //alert("数据：" + data + "\n状态：" + status);
    });
}

function collect(bid)
{
  var url = '/api?action=collect&param={"skey":"' + skey + '",' + '"userid":'+ userid  + ',"bid":' + bid + '}';
  console.log(url);
  $.get(url, function(data,status)
  {
      tmp = JSON.parse(data);
      
      document.getElementById('collect').innerHTML += '<br />'  + data;
    
      //alert("数据：" + data + "\n状态：" + status);
    });
}

function upgrade(bid)
{
  var url = '/api?action=upgrade&param={"skey":"' + skey + '",' + '"userid":'+ userid  + ',"bid":' + bid + '}';
  console.log(url);
  $.get(url, function(data,status)
  {
      tmp = JSON.parse(data);
      
      document.getElementById('upgrade').innerHTML += '<br />'  + data;
    
      //alert("数据：" + data + "\n状态：" + status);
    });
}

function activate(bid)
{
  var url = '/api?action=activate&param={"skey":"' + skey + '",' + '"userid":'+ userid  + ',"bid":' + bid + '}';
  console.log(url);
  $.get(url, function(data,status)
  {
      tmp = JSON.parse(data);
      
      document.getElementById('activate').innerHTML += '<br />'  + data;
    
      //alert("数据：" + data + "\n状态：" + status);
    });
}

function attack(attackuserid, bid, attackid)
{
  var url = '/api?action=attack&param={"skey":"' + skey + '","userid":'+ userid  + ',"attackbid":' + bid  + ',"attackuserid":' + attackuserid  +  ',"attackid":'+ attackid + '}';
  console.log(url);
  $.get(url, function(data,status)
  {
      tmp = JSON.parse(data);
      
      document.getElementById('attack').innerHTML += '<br />'  + data;
    
      //alert("数据：" + data + "\n状态：" + status);
    });
}




function  getfriend()
{

  var param = {"skey":skey, "userid":userid};
  var url = '/api?action=getfriend&param=' + JSON.stringify(param);
  console.log(url);
  $.get(url, function(data,status)
  {
      tmp = JSON.parse(data);
      
      document.getElementById('getfriend').innerHTML =  data;
    
      //alert("数据：" + data + "\n状态：" + status);
    });
}

function getfriendreq()
{

  var param = {"skey":skey, "userid":userid};
  var url = '/api?action=getfriendreq&param=' + JSON.stringify(param);
  console.log(url);
  $.get(url, function(data,status)
  {
      tmp = JSON.parse(data);
      
      document.getElementById('getfriendreq').innerHTML =  data;
    
      //alert("数据：" + data + "\n状态：" + status);
    });
}
function addfriend(name='test10')
{
  var param = {"skey":skey, "userid":userid, "otherusername":name};
  var url = '/api?action=addfriend&param=' + JSON.stringify(param);
  console.log(url);
  $.get(url, function(data,status)
  {
      tmp = JSON.parse(data);
      
      document.getElementById('addfriend').innerHTML += '<br />'  + data;
    
      //alert("数据：" + data + "\n状态：" + status);
    });
}

function acceptfriend(otherid, acode = 1)
{
  var param = {"skey":skey, "userid":userid, "otherid":otherid, 'acode':acode};
  var url = '/api?action=acceptfriend&param=' + JSON.stringify(param);
  console.log(url);
  $.get(url, function(data,status)
  {
      tmp = JSON.parse(data);
      
      document.getElementById('acceptfriend').innerHTML += '<br />'  + data;
    
      //alert("数据：" + data + "\n状态：" + status);
    });
}


</script>


</head>

<body>

  <div id="messages"></div>
  <div >
    <button onclick="userinfo()">
      userinfo
    </button>
    <div id="userinfo"></div>

    <button onclick="getconfig()">
      getconfig
    </button>
    <div id="getconfig"></div>
    

    <button onclick="getmap()">
      getmap
    </button>
    <div id="map"></div>

    <button onclick="getmapgen()">
      getmapgen
    </button>
    <div id="mapgen"></div>

    <button onclick="collect(3)">
      collect
    </button>
    <div id="collect"></div>

    <button onclick="upgrade(3)">
      upgrade
    </button>
    <div id="upgrade"></div>

    <button onclick="activate(3)">
      activate
    </button>
    <div id="activate"></div>

    <button onclick="attack(7, 3, 1)">
      attack
    </button>
    <div id="attack"></div>



    <button onclick="getfriend()">
      getfriend
    </button>
    <div id="getfriend"></div>
    <button onclick="getfriendreq()">
      getfriendreq
    </button>
    <div id="getfriendreq"></div>

    <button onclick="addfriend('test10')">
      addfriend
    </button>
    <div id="addfriend"></div>

    <button onclick="acceptfriend(12, 1)">
      acceptfriend
    </button>
    <div id="acceptfriend"></div>

  </div>

</body>

</html>